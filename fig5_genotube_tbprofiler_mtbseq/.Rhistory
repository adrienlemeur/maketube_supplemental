PTP_genotube <- sum(neutral_genotube$TP) / (sum(neutral_genotube$TP) + sum(neutral_genotube$FN))
PFN_genotube <- 1-PTP_genotube
PFP_genotube <- sum(neutral_genotube$FP)/reference_region_size*200
theoretical_metrics_calculator <- function(size, replicate, PTP, PFP, PFN, tag1, tag2){
TP <- rbinom(replicate, size, PTP)
FP <- rbinom(replicate, size, PFP)
FN <- rbinom(replicate, size, PFN)
PRECISION <- TP / (TP + FP)
RECALL <- TP / (TP + FN)
output <- cbind(tag1, tag2, size, TP, FP, FN, RECALL, PRECISION)
return(output)
}
}
PFP_genotube <- sum(total_genotube$FP)/reference_region_size*nrow(total_genotube)
theoretical_metrics_calculator <- function(size, replicate, PTP, PFP, PFN, tag1, tag2){
TP <- rbinom(replicate, size, PTP)
FP <- rbinom(replicate, size, PFP)
FN <- rbinom(replicate, size, PFN)
PRECISION <- TP / (TP + FP)
RECALL <- TP / (TP + FN)
output <- cbind(tag1, tag2, size, TP, FP, FN, RECALL, PRECISION)
return(output)
}
interval_size = c("DR_scar_regions" = 1800, "insertion_flanking_regions" = 4800, "IS_flanking_regions" = 9600, "IS_scar_regions" = 9600, "ANTIBIOTIC_GENE" = 50000, "duplicated_region" = 150000)
tmp <- lapply(names(interval_size), function(region_name) {
precision_calculator(interval_size[region_name], 200, PTP_genotube*PV, 0, PFN_genotube*PV, "genotube_theoretical", region_name)
})
interval_size = c("DR_scar_regions" = 1800, "insertion_flanking_regions" = 4800, "IS_flanking_regions" = 9600, "IS_scar_regions" = 9600, "ANTIBIOTIC_GENE" = 50000, "duplicated_region" = 150000)
tmp <- lapply(names(interval_size), function(region_name) {
precision_calculator(interval_size[region_name], 200, PTP_genotube*PV, 0, PFN_genotube*PV, "genotube_theoretical", region_name)
})
tmp <- lapply(names(interval_size), function(region_name) {
theoretical_metrics_calculator(interval_size[region_name], 200, PTP_genotube*PV, 0, PFN_genotube*PV, "genotube_theoretical", region_name)
})
PTP_genotube <- sum(total_genotube$TP) / (sum(total_genotube$TP) + sum(total_genotube$FN))
PFN_genotube <- 1-PTP_genotube
PFP_genotube <- sum(total_genotube$FP)/reference_region_size*nrow(total_genotube)
theoretical_metrics_calculator <- function(size, replicate, PTP, PFP, PFN, tag1, tag2){
TP <- rbinom(replicate, size, PTP)
FP <- rbinom(replicate, size, PFP)
FN <- rbinom(replicate, size, PFN)
PRECISION <- TP / (TP + FP)
RECALL <- TP / (TP + FN)
output <- cbind(tag1, tag2, size, TP, FP, FN, RECALL, PRECISION)
return(output)
}
interval_size = c("DR_scar_regions" = 1800, "insertion_flanking_regions" = 4800, "IS_flanking_regions" = 9600, "IS_scar_regions" = 9600, "ANTIBIOTIC_GENE" = 50000, "duplicated_region" = 150000)
tmp <- lapply(names(interval_size), function(region_name) {
theoretical_metrics_calculator(interval_size[region_name], 200, PTP_genotube*PV, 0, PFN_genotube*PV, "genotube_theoretical", region_name)
})
genotube_theoretical_distribution <- as.data.frame(do.call(rbind, tmp))
colnames(genotube_theoretical_distribution) <- c("pipeline", "region", "strain", "TP", "FP", "FN", "RECALL", "PRECISION")
tmp <- lapply(names(interval_size), function(region_name) precision_calculator(interval_size[region_name], 2000, PTP_tbprofiler*PV, PFP_tbprofiler*PIV, PFN_tbprofiler*PV, "tbprofiler_theoretical", region_name))
{
interval_size = c("DR_scar_regions" = 1800, "insertion_flanking_regions" = 4800, "IS_flanking_regions" = 9600, "IS_scar_regions" = 9600, "ANTIBIOTIC_GENE" = 50000, "duplicated_region" = 150000)
tmp <- lapply(names(interval_size), function(region_name) {
theoretical_metrics_calculator(interval_size[region_name], 200, PTP_genotube*PV, 0, PFN_genotube*PV, "genotube_theoretical", region_name)
})
genotube_theoretical_distribution <- as.data.frame(do.call(rbind, tmp))
colnames(genotube_theoretical_distribution) <- c("pipeline", "region", "strain", "TP", "FP", "FN", "RECALL", "PRECISION")
genotube_theoretical_distribution$TP <- as.numeric(both_distributions$TP)
genotube_theoretical_distribution$FP <- as.numeric(both_distributions$FP)
genotube_theoretical_distribution$FN <- as.numeric(both_distributions$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(both_distributions$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(both_distributions$RECALL)
genotube_theoretical_distribution <- genotube_theoretical_distribution[!(is.na(genotube_theoretical_distribution$RECALL) | is.na(genotube_theoretical_distribution$PRECISION)),]
#write.table(both_distributions, file = "theoretical_distributions.tsv", sep = "\t", row.names = F)
}
{
interval_size = c("DR_scar_regions" = 1800, "insertion_flanking_regions" = 4800, "IS_flanking_regions" = 9600, "IS_scar_regions" = 9600, "ANTIBIOTIC_GENE" = 50000, "duplicated_region" = 150000)
tmp <- lapply(names(interval_size), function(region_name) {
theoretical_metrics_calculator(interval_size[region_name], 200, PTP_genotube*PV, 0, PFN_genotube*PV, "genotube_theoretical", region_name)
})
genotube_theoretical_distribution <- as.data.frame(do.call(rbind, tmp))
colnames(genotube_theoretical_distribution) <- c("pipeline", "region", "strain", "TP", "FP", "FN", "RECALL", "PRECISION")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution <- genotube_theoretical_distribution[!(is.na(genotube_theoretical_distribution$RECALL) | is.na(genotube_theoretical_distribution$PRECISION)),]
#write.table(both_distributions, file = "theoretical_distributions.tsv", sep = "\t", row.names = F)
}
pla
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(PRECISION), col = pipeline))
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(RECALL), col = pipeline))
{
interval_size = c(500, 1000, 2000, 5000, 10000, 20000, 50000)
tmp <- lapply(names(interval_size), function(region_name) {
theoretical_metrics_calculator(interval_size[region_name], 200, PTP_genotube*PV, 0, PFN_genotube*PV, "genotube_theoretical", region_name)
})
genotube_theoretical_distribution <- as.data.frame(do.call(rbind, tmp))
colnames(genotube_theoretical_distribution) <- c("pipeline", "region", "strain", "TP", "FP", "FN", "RECALL", "PRECISION")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution <- genotube_theoretical_distribution[!(is.na(genotube_theoretical_distribution$RECALL) | is.na(genotube_theoretical_distribution$PRECISION)),]
#write.table(both_distributions, file = "theoretical_distributions.tsv", sep = "\t", row.names = F)
}
interval_size = c(500 = 500, 1000, 2000, 5000, 10000, 20000, 50000)
{
interval_size = c("500" = 500, "1000" = 1000, "2000" = 2000, "5000" = 5000, "10000" = 10000, "20000" = 20000, "50000" = 50000)
tmp <- lapply(names(interval_size), function(region_name) {
theoretical_metrics_calculator(interval_size[region_name], 200, PTP_genotube*PV, 0, PFN_genotube*PV, "genotube_theoretical", region_name)
})
genotube_theoretical_distribution <- as.data.frame(do.call(rbind, tmp))
colnames(genotube_theoretical_distribution) <- c("pipeline", "region", "strain", "TP", "FP", "FN", "RECALL", "PRECISION")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution <- genotube_theoretical_distribution[!(is.na(genotube_theoretical_distribution$RECALL) | is.na(genotube_theoretical_distribution$PRECISION)),]
#write.table(both_distributions, file = "theoretical_distributions.tsv", sep = "\t", row.names = F)
}
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(PRECISION), col = pipeline))
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(RECALL), col = pipeline))
interval_size = c(500, 1000, 2000, 5000, 10000, 20000, 50000)
tmp <- lapply(interval_size, function(region_name) {
theoretical_metrics_calculator(interval_size[region_name], 200, PTP_genotube*PV, 0, PFN_genotube*PV, "genotube_theoretical", region_name)
})
tmp <- lapply(interval_size, function(region_name) {
theoretical_metrics_calculator(interval_size, 200, PTP_genotube*PV, 0, PFN_genotube*PV, "genotube_theoretical")
})
theoretical_metrics_calculator <- function(size, replicate, PTP, PFP, PFN){
TP <- rbinom(replicate, size, PTP)
FP <- rbinom(replicate, size, PFP)
FN <- rbinom(replicate, size, PFN)
PRECISION <- TP / (TP + FP)
RECALL <- TP / (TP + FN)
output <- cbind(tag1, tag2, size, TP, FP, FN, RECALL, PRECISION)
return(output)
}
{
interval_size = c(500, 1000, 2000, 5000, 10000, 20000, 50000)
tmp <- lapply(interval_size, function(region_name) {
theoretical_metrics_calculator(interval_size, 1000, PTP_genotube*PV, 0, PFN_genotube*PV)
})
genotube_theoretical_distribution <- as.data.frame(do.call(rbind, tmp))
colnames(genotube_theoretical_distribution) <- c("pipeline", "region", "strain", "TP", "FP", "FN", "RECALL", "PRECISION")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution <- genotube_theoretical_distribution[!(is.na(genotube_theoretical_distribution$RECALL) | is.na(genotube_theoretical_distribution$PRECISION)),]
#write.table(both_distributions, file = "theoretical_distributions.tsv", sep = "\t", row.names = F)
}
theoretical_metrics_calculator <- function(size, replicate, PTP, PFP, PFN){
TP <- rbinom(replicate, size, PTP)
FP <- rbinom(replicate, size, PFP)
FN <- rbinom(replicate, size, PFN)
PRECISION <- TP / (TP + FP)
RECALL <- TP / (TP + FN)
output <- cbind(size, TP, FP, FN, RECALL, PRECISION)
return(output)
}
{
results_by_region <- read.table("three_variant_caller_results.tsv", sep = "\t", header = F)
colnames(results_by_region) <- c("pipeline", "filter", "variant_caller", "experience", "region", "region2", "variant_class", "TP", "FP", "FN", "RECALL", "PRECISION", "F1")
total_genotube <- subset(results_by_region, variant_caller == "genotube" & experience == 'dupli')
reference_region_size <- 3842481
PV <- (sum(total_genotube$TP) + sum(total_genotube$FN))/(reference_region_size*nrow(total_genotube))
PIV <- 1 - PV
PTP_genotube <- sum(total_genotube$TP) / (sum(total_genotube$TP) + sum(total_genotube$FN))
PFN_genotube <- 1-PTP_genotube
PFP_genotube <- sum(total_genotube$FP)/reference_region_size*nrow(total_genotube)
theoretical_metrics_calculator <- function(size, replicate, PTP, PFP, PFN){
TP <- rbinom(replicate, size, PTP)
FP <- rbinom(replicate, size, PFP)
FN <- rbinom(replicate, size, PFN)
PRECISION <- TP / (TP + FP)
RECALL <- TP / (TP + FN)
output <- cbind(size, TP, FP, FN, RECALL, PRECISION)
return(output)
}
}
{
interval_size = c(500, 1000, 2000, 5000, 10000, 20000, 50000)
tmp <- lapply(interval_size, function(region_name) {
theoretical_metrics_calculator(interval_size, 1000, PTP_genotube*PV, 0, PFN_genotube*PV)
})
genotube_theoretical_distribution <- as.data.frame(do.call(rbind, tmp))
colnames(genotube_theoretical_distribution) <- c("pipeline", "region", "strain", "TP", "FP", "FN", "RECALL", "PRECISION")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution <- genotube_theoretical_distribution[!(is.na(genotube_theoretical_distribution$RECALL) | is.na(genotube_theoretical_distribution$PRECISION)),]
#write.table(both_distributions, file = "theoretical_distributions.tsv", sep = "\t", row.names = F)
}
{
results_by_region <- read.table("three_variant_caller_results.tsv", sep = "\t", header = F)
colnames(results_by_region) <- c("pipeline", "filter", "variant_caller", "experience", "region", "region2", "variant_class", "TP", "FP", "FN", "RECALL", "PRECISION", "F1")
total_genotube <- subset(results_by_region, variant_caller == "genotube" & experience == 'dupli')
reference_region_size <- 3842481
PV <- (sum(total_genotube$TP) + sum(total_genotube$FN))/(reference_region_size*nrow(total_genotube))
PIV <- 1 - PV
PTP_genotube <- sum(total_genotube$TP) / (sum(total_genotube$TP) + sum(total_genotube$FN))
PFN_genotube <- 1-PTP_genotube
PFP_genotube <- sum(total_genotube$FP)/reference_region_size*nrow(total_genotube)
theoretical_metrics_calculator <- function(size, replicate, PTP, PFP, PFN){
TP <- rbinom(replicate, size, PTP)
FP <- rbinom(replicate, size, PFP)
FN <- rbinom(replicate, size, PFN)
PRECISION <- TP / (TP + FP)
RECALL <- TP / (TP + FN)
output <- cbind(size, TP, FP, FN, RECALL, PRECISION)
return(output)
}
}
{
interval_size = c(500, 1000, 2000, 5000, 10000, 20000, 50000)
tmp <- lapply(interval_size, function(region_name) {
theoretical_metrics_calculator(interval_size, 1000, PTP_genotube*PV, 0, PFN_genotube*PV)
})
genotube_theoretical_distribution <- as.data.frame(do.call(rbind, tmp))
colnames(genotube_theoretical_distribution) <- c("pipeline", "region", "strain", "TP", "FP", "FN", "RECALL", "PRECISION")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution <- genotube_theoretical_distribution[!(is.na(genotube_theoretical_distribution$RECALL) | is.na(genotube_theoretical_distribution$PRECISION)),]
#write.table(both_distributions, file = "theoretical_distributions.tsv", sep = "\t", row.names = F)
}
interval_size
sapply(interval_size, function(x) {theoretical_metrics_calculator(x, 1000, PTP_genotube*PV, 0, PFN_genotube*PV)}}
sapply(interval_size, function(x) theoretical_metrics_calculator(x, 1000, PTP_genotube*PV, 0, PFN_genotube*PV)}
sapply(interval_size, function(x) theoretical_metrics_calculator(x, 1000, PTP_genotube*PV, 0, PFN_genotube*PV))
tmp <- lapply(interval_size, function(x) {
theoretical_metrics_calculator(x, 1000, PTP_genotube*PV, 0, PFN_genotube*PV)
})
theoretical_metrics_calculator
genotube_theoretical_distribution <- as.data.frame(do.call(rbind, tmp))
colnames(genotube_theoretical_distribution) <- c("pipeline", "region", "strain", "TP", "FP", "FN", "RECALL", "PRECISION")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution <- as.data.frame(do.call(rbind, tmp))
colnames(genotube_theoretical_distribution) <- c("pipeline", "region", "strain", "TP", "FP", "FN")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution <- genotube_theoretical_distribution[!(is.na(genotube_theoretical_distribution$RECALL) | is.na(genotube_theoretical_distribution$PRECISION)),]
genotube_theoretical_distribution <- as.data.frame(do.call(rbind, tmp))
colnames(genotube_theoretical_distribution) <- c("pipeline", "region", "strain", "TP", "FP", "FN")
genotube_theoretical_distribution
na.omit(as.data.frame(do.call(rbind, tmp)))
genotube_theoretical_distribution <- na.omit(as.data.frame(do.call(rbind, tmp)))
colnames(genotube_theoretical_distribution) <- c("pipeline", "region", "strain", "TP", "FP", "FN")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution
theoretical_metrics_calculator <- function(size, replicate, PTP, PFP, PFN){
TP <- rbinom(replicate, size, PTP)
FP <- rbinom(replicate, size, PFP)
FN <- rbinom(replicate, size, PFN)
PRECISION <- TP / (TP + FP)
RECALL <- TP / (TP + FN)
output <- cbind(size, TP, FP, FN, RECALL, PRECISION)
return(output)
}
interval_size = c(500, 1000, 2000, 5000, 10000, 20000, 50000)
tmp <- lapply(interval_size, function(x) {
theoretical_metrics_calculator(x, 1000, PTP_genotube*PV, 0, PFN_genotube*PV)
})
genotube_theoretical_distribution <- na.omit(as.data.frame(do.call(rbind, tmp)))
genotube_theoretical_distribution
colnames(genotube_theoretical_distribution) <- c("pipeline", "region", "strain", "TP", "FP", "FN", "PRECISION", "RECALL")
colnames(genotube_theoretical_distribution) <- c("region", "strain", "TP", "FP", "FN", "PRECISION", "RECALL")
colnames(genotube_theoretical_distribution) <- c("region", "TP", "FP", "FN", "PRECISION", "RECALL")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(PRECISION), col = pipeline))
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(PRECISION), col = pipeline))
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(PRECISION)))
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(PRECISION), group = region))
genotube_theoretical_distribution
as.factor(genotube_theoretical_distribution$region)
genotube_theoretical_distribution$region <- as.factor(genotube_theoretical_distribution$region)
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(PRECISION), group = region))
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(RECALL)))
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(RECALL)), , group = region)
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(RECALL)), group = region)
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(RECALL), group = region))
PFP_genotube
tmp <- lapply(interval_size, function(x) {
theoretical_metrics_calculator(x, 1000, PTP_genotube*PV, PFP_genotube*PF, PFN_genotube*PV)
})
PTP_genotube
PV
tmp <- lapply(interval_size, function(x) {
theoretical_metrics_calculator(x, 1000, PTP_genotube*PV, PFP_genotube*PV, PFN_genotube*PV)
})
genotube_theoretical_distribution <- na.omit(as.data.frame(do.call(rbind, tmp)))
colnames(genotube_theoretical_distribution) <- c("region", "TP", "FP", "FN", "PRECISION", "RECALL")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution$region <- as.factor(genotube_theoretical_distribution$region)
{
interval_size = c(500, 1000, 2000, 5000, 10000, 20000, 50000)
tmp <- lapply(interval_size, function(x) {
theoretical_metrics_calculator(x, 1000, PTP_genotube*PV, PFP_genotube*PV, PFN_genotube*PV)
})
genotube_theoretical_distribution <- na.omit(as.data.frame(do.call(rbind, tmp)))
colnames(genotube_theoretical_distribution) <- c("region", "TP", "FP", "FN", "PRECISION", "RECALL")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution$region <- as.factor(genotube_theoretical_distribution$region)
}
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(PRECISION), group = region))
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(RECALL), group = region))
PV <- (sum(total_genotube$TP) + sum(total_genotube$FN))/(reference_region_size*nrow(total_genotube))
PIV <- 1 - PV
PTP_genotube <- sum(total_genotube$TP) / (sum(total_genotube$TP) + sum(total_genotube$FN))
PFN_genotube <- 1-PTP_genotube
PFP_genotube <- sum(total_genotube$FP)/reference_region_size*nrow(total_genotube)
theoretical_metrics_calculator <- function(size, replicate, PTP, PFP, PFN){
TP <- rbinom(replicate, size, PTP)
FP <- rbinom(replicate, size, PFP)
FN <- rbinom(replicate, size, PFN)
PRECISION <- TP / (TP + FP)
RECALL <- TP / (TP + FN)
output <- cbind(size, TP, FP, FN, RECALL, PRECISION)
return(output)
}
PIV
PFP_genotube*PIV
{
results_by_region <- read.table("three_variant_caller_results.tsv", sep = "\t", header = F)
colnames(results_by_region) <- c("pipeline", "filter", "variant_caller", "experience", "region", "region2", "variant_class", "TP", "FP", "FN", "RECALL", "PRECISION", "F1")
total_genotube <- subset(results_by_region, variant_caller == "genotube" & experience == 'dupli')
reference_region_size <- 3842481
PV <- (sum(total_genotube$TP) + sum(total_genotube$FN))/(reference_region_size*nrow(total_genotube))
PIV <- 1 - PV
PTP_genotube <- sum(total_genotube$TP) / (sum(total_genotube$TP) + sum(total_genotube$FN))
PFN_genotube <- 1-PTP_genotube
PFP_genotube <- sum(total_genotube$FP)/reference_region_size*nrow(total_genotube)
theoretical_metrics_calculator <- function(size, replicate, PTP, PFP, PFN){
TP <- rbinom(replicate, size, PTP)
FP <- rbinom(replicate, size, PFP)
FN <- rbinom(replicate, size, PFN)
PRECISION <- TP / (TP + FP)
RECALL <- TP / (TP + FN)
output <- cbind(size, TP, FP, FN, RECALL, PRECISION)
return(output)
}
}
{
interval_size = c(500, 1000, 2000, 5000, 10000, 20000, 50000)
tmp <- lapply(interval_size, function(x) {
theoretical_metrics_calculator(x, 1000, PTP_genotube*PV, PFP_genotube*PIV, PFN_genotube*PV)
})
genotube_theoretical_distribution <- na.omit(as.data.frame(do.call(rbind, tmp)))
colnames(genotube_theoretical_distribution) <- c("region", "TP", "FP", "FN", "PRECISION", "RECALL")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution$region <- as.factor(genotube_theoretical_distribution$region)
}
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(PRECISION), group = region))
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(RECALL), group = region))
PTP_genotube
PV
tmp <- lapply(interval_size, function(x) {
theoretical_metrics_calculator(x, 1000, PTP_genotube*PV, PFP_genotube*PV, PFN_genotube*PIV)
})
genotube_theoretical_distribution <- na.omit(as.data.frame(do.call(rbind, tmp)))
colnames(genotube_theoretical_distribution) <- c("region", "TP", "FP", "FN", "PRECISION", "RECALL")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution$region <- as.factor(genotube_theoretical_distribution$region)
{
interval_size = c(500, 1000, 2000, 5000, 10000, 20000, 50000)
tmp <- lapply(interval_size, function(x) {
theoretical_metrics_calculator(x, 1000, PTP_genotube*PV, PFP_genotube*PV, PFN_genotube*PIV)
})
genotube_theoretical_distribution <- na.omit(as.data.frame(do.call(rbind, tmp)))
colnames(genotube_theoretical_distribution) <- c("region", "TP", "FP", "FN", "PRECISION", "RECALL")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution$region <- as.factor(genotube_theoretical_distribution$region)
}
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(PRECISION), group = region))
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(RECALL), group = region))
PTP_genotube
PTP_genotube*PV
PFN_genotube*PV
PFN_genotube*PV
PIV
{
interval_size = c(500, 1000, 2000, 5000, 10000, 20000, 50000)
tmp <- lapply(interval_size, function(x) {
theoretical_metrics_calculator(x, 1000, PTP_genotube*PV, PTP_genotube*PV, PFN_genotube*PV)
})
genotube_theoretical_distribution <- na.omit(as.data.frame(do.call(rbind, tmp)))
colnames(genotube_theoretical_distribution) <- c("region", "TP", "FP", "FN", "PRECISION", "RECALL")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution$region <- as.factor(genotube_theoretical_distribution$region)
}
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(PRECISION), group = region))
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(RECALL), group = region))
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(PRECISION), group = region))
?rbinom
PTP_genotube*PV
results_by_region
results_by_region <- read.table("three_variant_caller_results.tsv", sep = "\t", header = F)
colnames(results_by_region) <- c("pipeline", "filter", "variant_caller", "experience", "region", "region2", "variant_class", "TP", "FP", "FN", "RECALL", "PRECISION", "F1")
total_genotube <- subset(results_by_region, pipeline == "maketube" & variant_caller == "genotube" & experience == 'dupli')
reference_region_size <- 3842481
PV <- (sum(total_genotube$TP) + sum(total_genotube$FN))/(reference_region_size*nrow(total_genotube))
PIV <- 1 - PV
PTP_genotube <- sum(total_genotube$TP) / (sum(total_genotube$TP) + sum(total_genotube$FN))
PFN_genotube <- 1-PTP_genotube
PFP_genotube <- sum(total_genotube$FP)/reference_region_size*nrow(total_genotube)
theoretical_metrics_calculator <- function(size, replicate, PTP, PFP, PFN){
TP <- rbinom(replicate, size, PTP)
FP <- rbinom(replicate, size, PFP)
FN <- rbinom(replicate, size, PFN)
PRECISION <- TP / (TP + FP)
RECALL <- TP / (TP + FN)
output <- cbind(size, TP, FP, FN, RECALL, PRECISION)
return(output)
}
{
interval_size = c(500, 1000, 2000, 5000, 10000, 20000, 50000)
tmp <- lapply(interval_size, function(x) {
theoretical_metrics_calculator(x, 1000, PTP_genotube*PV, PTP_genotube*PV, PFN_genotube*PV)
})
genotube_theoretical_distribution <- na.omit(as.data.frame(do.call(rbind, tmp)))
colnames(genotube_theoretical_distribution) <- c("region", "TP", "FP", "FN", "PRECISION", "RECALL")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution$region <- as.factor(genotube_theoretical_distribution$region)
}
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(PRECISION), group = region))
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(RECALL), group = region))
tmp <- lapply(interval_size, function(x) {
theoretical_metrics_calculator(x, 1000, PTP_genotube*PV, PTP_genotube*PIV, PFN_genotube*PV)
})
genotube_theoretical_distribution <- na.omit(as.data.frame(do.call(rbind, tmp)))
colnames(genotube_theoretical_distribution) <- c("region", "TP", "FP", "FN", "PRECISION", "RECALL")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution$region <- as.factor(genotube_theoretical_distribution$region)
{
interval_size = c(500, 1000, 2000, 5000, 10000, 20000, 50000)
tmp <- lapply(interval_size, function(x) {
theoretical_metrics_calculator(x, 1000, PTP_genotube*PV, PTP_genotube*PIV, PFN_genotube*PV)
})
genotube_theoretical_distribution <- na.omit(as.data.frame(do.call(rbind, tmp)))
colnames(genotube_theoretical_distribution) <- c("region", "TP", "FP", "FN", "PRECISION", "RECALL")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution$region <- as.factor(genotube_theoretical_distribution$region)
}
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(PRECISION), group = region))
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(RECALL), group = region))
PFP_genotube
PFP_genotube*PIV
tmp <- lapply(interval_size, function(x) {
theoretical_metrics_calculator(x, 1000, PTP_genotube*PV, PFP_genotube*PIV, PFN_genotube*PV)
})
genotube_theoretical_distribution <- na.omit(as.data.frame(do.call(rbind, tmp)))
colnames(genotube_theoretical_distribution) <- c("region", "TP", "FP", "FN", "PRECISION", "RECALL")
genotube_theoretical_distribution$TP <- as.numeric(genotube_theoretical_distribution$TP)
genotube_theoretical_distribution$FP <- as.numeric(genotube_theoretical_distribution$FP)
genotube_theoretical_distribution$FN <- as.numeric(genotube_theoretical_distribution$FN)
genotube_theoretical_distribution$PRECISION <- as.numeric(genotube_theoretical_distribution$PRECISION)
genotube_theoretical_distribution$RECALL <- as.numeric(genotube_theoretical_distribution$RECALL)
genotube_theoretical_distribution$region <- as.factor(genotube_theoretical_distribution$region)
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(PRECISION), group = region))
ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(RECALL), group = region))
A <- ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(PRECISION), group = region))
B <- ggplot(genotube_theoretical_distribution) + geom_boxplot(aes(region, as.numeric(RECALL), group = region))
A / B
